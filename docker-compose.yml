version: '3.8'

services:
  cert-renew:
    image: aliyun-cert-renew:latest
    container_name: cert-renew
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      # 必需：阿里云 AccessKey
      - ALIYUN_ACCESS_KEY_ID_RENEW=${ALIYUN_ACCESS_KEY_ID_RENEW}
      - ALIYUN_ACCESS_KEY_SECRET_RENEW=${ALIYUN_ACCESS_KEY_SECRET_RENEW}
      # 可选：日志配置
      - LOG_OUTPUT=${LOG_OUTPUT:-console}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      # 配置文件路径
      - DOMAINS_CONFIG_PATH=/app/config/domains.yaml
    volumes:
      # 挂载 domains.yaml 配置文件
      - ./domains.yaml:/app/config/domains.yaml:ro
      # 挂载日志目录
      - ./logs:/app/logs
    # 容器运行完脚本后自动退出，不自动重启
    # 如需在宿主机上设置定时任务，可使用 cron 或 systemd timer
